---
phase: 02-error-handling
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/not-found.tsx
  - src/app/global-error.tsx
  - src/app/components/MovieGridServer.tsx
  - src/app/components/MovieGrid.tsx
  - src/app/recommendations/RecommendationsClient.tsx
  - src/app/recommendations/page.tsx
  - src/app/search/page.tsx
autonomous: true
requirements:
  - ERR-02
  - ERR-03

must_haves:
  truths:
    - "Custom 404 page shows user-friendly message with error code"
    - "Custom 404 page includes Home link and Go Back button"
    - "Custom 404 page shows technical error details for developers"
    - "Custom 500 page handles server errors gracefully"
    - "MovieGrid wrapped with error boundary - shows error for that component only"
    - "Recommendations section wrapped with error boundary"
    - "All error boundaries use consistent styling"
    - "Critical UI sections isolated - one failure doesn't break entire page"
  artifacts:
    - path: "src/app/not-found.tsx"
      provides: "Custom 404 error page"
      contains: "ErrorBoundary or error handling UI"
    - path: "src/app/global-error.tsx"
      provides: "Global error handler for 500 errors"
      contains: "error.tsx pattern for Next.js"
    - path: "src/app/components/MovieGridServer.tsx"
      provides: "MovieGrid with error boundary"
      contains: "AppErrorBoundary wrapper"
  key_links:
    - from: "src/app/not-found.tsx"
      to: "src/app/page.tsx"
      via: "Home link"
      pattern: "href=\"/\""
    - from: "MovieGridServer.tsx"
      to: "ErrorBoundary.tsx"
      via: "AppErrorBoundary wrapper"
      pattern: "AppErrorBoundary"
---

<objective>
Create custom error pages (404, 500) and wrap critical UI sections with error boundaries for component isolation.
</objective>

<execution_context>
@C:/Users/n0rds/.config/opencode/get-shit-done/workflows/execute-plan.md
@C:/Users/n0rds/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-error-handling/02-CONTEXT.md

# User Decisions (LOCKED - implement exactly):
- Error pages: custom themed (not Next.js default), minimal design, Home link + Go Back button, show technical error details
- Error boundary scope: All major components need error boundaries, component isolation, consistent styling

Note: AsyncErrorBoundary extension is in Plan 01 - use it for wrapping UI components
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create custom 404 and 500 error pages</name>
  <files>src/app/not-found.tsx, src/app/global-error.tsx</files>
  <action>
    Create custom error pages following user decisions:
    
    1. Create src/app/not-found.tsx (custom 404):
       - Minimal design (not themed illustrations)
       - User-friendly message: "Страница не найдена"
       - Include error code (e.g., "ERR-404")
       - Show technical details for developers (error message, stack)
       - Add Home link (href="/")
       - Add Go Back button (uses router.back())
       - Custom themed (not Next.js default)
       
    2. Create src/app/global-error.tsx (custom 500):
       - Same styling as 404 for consistency
       - User-friendly message: "Внутренняя ошибка сервера"
       - Include error code
       - Show technical error details
       - Include Home link and Go Back button
       
    Per user decision: "Custom themed error pages (not Next.js default)", "Minimal design", "Include both Home link and Go Back button", "Show technical error details (for developers)"
  </action>
  <verify>
    1. Check not-found.tsx exists with 404 content
    2. Check global-error.tsx exists with 500 content
    3. Verify both include Home link and Go Back button
    4. Verify both show technical error details
    5. Verify minimal design (no large illustrations)
  </verify>
  <done>
    Custom 404 and 500 pages exist. Both show error code, technical details, Home link, and Go Back button. Minimal design applied.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wrap critical UI sections with error boundaries</name>
  <files>
    - src/app/components/MovieGridServer.tsx
    - src/app/components/MovieGrid.tsx
    - src/app/recommendations/RecommendationsClient.tsx
    - src/app/recommendations/page.tsx
    - src/app/search/page.tsx
  </files>
  <action>
    Wrap critical UI sections with error boundaries for component isolation:
    
    1. Wrap MovieGrid component:
       - Import AppErrorBoundary from src/app/components/ErrorBoundary.tsx
       - Wrap the movie grid content with AppErrorBoundary
       - Provide component-specific fallback showing "Ошибка загрузки фильмов"
       
    2. Wrap Recommendations section:
       - Wrap RecommendationsClient with AppErrorBoundary
       - Show "Рекомендации временно недоступны" on error
       
    3. Wrap Search results:
       - Wrap search results with error boundary
       - Show "Не удалось загрузить результаты поиска"
       
    4. Use consistent styling across all error boundaries:
       - Red border/error styling
       - Component-specific error messages
       - Manual refresh button (no auto-retry)
       
    Per user decision: "All major components need error boundaries", "Component isolation: show error state for that component only", "Consistent styling across all error boundaries", "No automatic retry - manual refresh only", "Component-specific error messages"
    
    Note: This builds on extended AsyncErrorBoundary from Plan 01. Use the enhanced component if needed.
  </action>
  <verify>
    1. Check MovieGridServer.tsx wraps content with AppErrorBoundary
    2. Check RecommendationsClient.tsx wrapped with error boundary
    3. Check search page wrapped with error boundary
    4. Verify each has component-specific fallback message
    5. Verify consistent styling (red border, centered)
  </verify>
  <done>
    MovieGrid, Recommendations, and Search are wrapped with error boundaries. When one fails, only that component shows error - rest of page works. Consistent styling applied.
  </done>
</task>

</tasks>

<verification>
1. Custom 404 page with Home link, Go Back, technical details exists
2. Custom 500 (global-error) page exists
3. MovieGrid wrapped with error boundary
4. Recommendations wrapped with error boundary
5. Search wrapped with error boundary
6. All error boundaries use consistent styling
7. Each shows component-specific error message
</verification>

<success_criteria>
- Custom 404 and 500 pages created per user decisions
- Critical UI sections (MovieGrid, Recommendations, Search) have error boundaries
- Component isolation: one failure doesn't break entire page
- Consistent styling across all error boundaries
- Manual refresh only (no auto-retry)
</success_criteria>

<output>
After completion, create `.planning/phases/02-error-handling/02-02-SUMMARY.md`
</output>
