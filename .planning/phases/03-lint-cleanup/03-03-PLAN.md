---
phase: 03-lint-cleanup
plan: 03
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: true
requirements: []
gap_closure: true
must_haves:
  truths:
    - "npm run lint проходит без ошибок (0 errors)"
    - "Нет неиспользуемых переменных (catch block errors)"
    - "Нет проблем с react-hooks"
  artifacts: []
  key_links: []
---

<objective>
Исправить оставшиеся 408 ошибок lint для достижения цели "npm run lint = 0 errors".

Gap closure: адресует failed must-haves из VERIFICATION.md после планов 03-01 и 03-02.
</objective>

<context>
# Gaps from VERIFICATION.md (after 03-01 + 03-02)

## Current state
- 408 errors, 155 warnings
- console.log → logger: DONE (03-01)
- Core lib files typed (03-02)

## Remaining gaps
- 197 @typescript-eslint/no-explicit-any errors
- ~200 no-unused-vars errors (mostly catch block unused error variables)
- 28 react-hooks issues

## Key problem areas
1. Catch blocks с неиспользуемыми error переменными (56+ файлов)
2. any типы в API routes (search, recommendations)
3. setState в useEffect (components)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Исправить неиспользуемые catch block переменные</name>
  <files>[]</files>
  <action>
Найти все catch блоки с неиспользуемыми error переменными:
1. Запустить `npm run lint 2>&1 | grep "catch" | head -30` для поиска
2. Для каждого catch: использовать `catch (_error)` или `catch { /* ignore */ }`
3. Прогнать `npx eslint --fix` для авто-исправления

Фокус на API routes: src/app/api/**/*.ts
  </action>
  <verify>`npm run lint 2>&1 | grep -c "catch.*never used"`</verify>
  <done>Минимум неиспользуемых catch переменных</done>
</task>

<task type="auto">
  <name>Task 2: Типизировать ключевые API routes</name>
  <files>[]</files>
  <action>
Типизировать самые проблемные файлы:
1. src/app/api/search/route.ts (18+ any errors)
2. src/app/api/recommendations/*.ts
3. src/app/api/my-movies/route.ts

Использовать:
- unknown где тип неизвестен
- Record<string, unknown> для объектов
- Создать базовые типы для TMDB ответов
  </action>
  <verify>`npm run lint 2>&1 | grep -c "@typescript-eslint/no-explicit-any"`</verify>
  <done>Минимум any ошибок</done>
</task>

<task type="auto">
  <name>Task 3: Исправить react-hooks проблемы</name>
  <files>[]</files>
  <action>
Для react-hooks ошибок:
1. set-state-in-effect: убрать setState из useEffect, использовать условную логику
2. exhaustive-deps: добавить правильные зависимости
3. Исправить в: AuthModal, FilmGridWithFilters, AsyncErrorBoundary
  </action>
  <verify>`npm run lint 2>&1 | grep -c "react-hooks"`</verify>
  <done>0 react-hooks ошибок</done>
</task>

<task type="auto">
  <name>Task 4: Финальная проверка</name>
  <files>[]</files>
  <action>
Запустить `npm run lint` и убедиться что:
- 0 errors
- Предупреждения минимальны
  </action>
  <verify>`npm run lint`</verify>
  <done>npm run lint = 0 errors</done>
</task>

</tasks>

<verification>
`npm run lint` возвращает 0 errors
</verification>

<success_criteria>
- Достигнута цель: npm run lint = 0 errors
- Исправлены все 408 оставшихся errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-lint-cleanup/{phase}-03-SUMMARY.md`
</output>
